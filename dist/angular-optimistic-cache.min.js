angular.module("rt.optimisticcache",[]).factory("optimisticCache",function(){function a(a){return e[a]}function b(a,d,f){if(f||(f={}),f.mapper)if(angular.isArray(d))for(var g=0;g<d.length;g++)d[g]=f.mapper(d[g]);else d=f.mapper(d);if(c(e,a,d),angular.isArray(d)&&f.populateChildren)for(var h=0;h<d.length;h++){var i=d[h];b(a+"/"+i[f.idField],i)}}function c(a,b,d){if(d)if(a[b]){var e=a[b];if(angular.isArray(e)){for(var f=0;f<d.length;f++)c(e,f,angular.copy(d[f]));e.length=d.length}else for(var g in d)e[g]=d[g]}else a[b]=d}function d(d,e,f){return f||(f={}),(null===f.idField||void 0===f.idField)&&(f.idField="id"),(null===f.populateChildren||void 0===f.populateChildren)&&(f.populateChildren=!0),d.then(function(a){b(e,a,f)}),d.toScope=function(b,f){return c(b,f,a(e)),d.then(function(){c(b,f,a(e))}),d.then(function(){return b[f]})},d}var e={};return d.clear=function(){e={}},d});